{% extends "base.html" %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; padding: 0 5px;">
    <div style="display: flex; flex-direction: column; gap: 4px;">
        <div style="display: flex; align-items: center; gap: 15px;">
            <a href="{{ url_for('networks_page') }}" style="color: white; text-decoration: none; font-size: 1.5rem; display: flex; align-items: center;">
                <i class="fas fa-chevron-left"></i>
            </a>
            <h1 style="font-size: 2.4rem; margin: 0; font-weight: 700;">Members</h1>
        </div>
        <p style="color: #10b981; margin: 0 0 0 42px; font-weight: 600; font-size: 1.1rem;">
            â— {{ online_count }} Online
        </p>
    </div>

    <div style="position: relative; margin-top: 10px;">
        <select onchange="location.href='?sort=' + this.value" 
                style="background: #1e293b; color: white; border: 1px solid #334155; padding: 12px 40px 12px 18px; border-radius: 14px; font-size: 1rem; appearance: none; cursor: pointer;">
            <option value="last_seen" {% if sort_by == 'last_seen' %}selected{% endif %}>Recent</option>
            <option value="name" {% if sort_by == 'name' %}selected{% endif %}>Name</option>
        </select>
        <i class="fas fa-chevron-down" style="position: absolute; right: 15px; top: 16px; font-size: 0.8rem; color: #94a3b8; pointer-events: none;"></i>
    </div>
</div>

<div class="members-list">
    {% for m in members %}
    <div class="network-card" style="position: relative; padding: 25px; margin-bottom: 15px; background: #1a2232; border-radius: 20px; border: 1px solid #2d384a; overflow: hidden; display: flex; justify-content: space-between; align-items: center;">
        
        {% if m.online %}
        <div style="position: absolute; left: 0; top: 20%; bottom: 20%; width: 5px; background: #10b981; box-shadow: 0 0 15px #10b981; border-radius: 0 4px 4px 0;"></div>
        {% endif %}
        
        <div style="display: flex; flex-direction: column; gap: 8px;">
            <h3 style="margin: 0; font-size: 1.6rem; font-weight: 700; color: {% if m.online %}#10b981{% else %}#fff{% endif %};">
                {{ m.name }}
            </h3>
            <div style="color: #94a3b8; font-size: 1.1rem; display: flex; align-items: center; gap: 6px; cursor: pointer;" onclick="copyToClipboard('{{ m.ip }}', event)">
                <i class="fas fa-link" style="font-size: 0.9rem; opacity: 0.6;"></i> 
                {{ m.ip }}
            </div>
        </div>

        <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 8px;">
            <div style="height: 1.6rem; display: flex; align-items: center;">
                {% if m.authorized %}
                    <i class="fas fa-shield-halved" style="color: #3b82f6; font-size: 1.6rem;"></i>
                {% else %}
                    <i class="fas fa-lock-open" style="color: #64748b; font-size: 1.6rem;"></i>
                {% endif %}
            </div>
            <span style="color: #64748b; font-size: 1rem;">{{ m.last_seen }}</span>
        </div>
    </div>
    {% endfor %}
</div>

<script>
function copyToClipboard(text, event) {
    event.stopPropagation();
    navigator.clipboard.writeText(text).then(() => {
        const target = event.currentTarget;
        const originalContent = target.innerHTML;
        target.style.color = "#10b981";
        target.innerHTML = '<i class="fas fa-check"></i> Copied';
        setTimeout(() => {
            target.style.color = "#94a3b8";
            target.innerHTML = originalContent;
        }, 1200);
    });
}
</script>
{% endblock %}
